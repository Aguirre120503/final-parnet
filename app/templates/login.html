{% extends 'base.html' %}
{% block title %}Iniciar sesión | ParNet Ingeniería{% endblock %}
{% block styles %}
  <link rel="stylesheet" href="{{ url_for('static', filename='css/login.css') }}">
{% endblock %}
{% block content %}
<div class="login-wrapper">

    <div class="login-box">
      <h1>Iniciar Sesión</h1>
      <p class="login-subtitle">Selecciona tu tipo de acceso</p>

      <form id="form-login">

        <label for="rol">Ingresar como:</label>
        <select id="rol" name="rol">
          <option value="admin">Administrador</option>
          <option value="cliente">Cliente</option>
        </select>

        <label for="usuario">Usuario</label>
        <input type="text" id="usuario" name="usuario" placeholder="Usuario">

        <label for="password">Contraseña</label>
        <input type="password" id="password" name="password" placeholder="Contraseña">

        <button type="submit">Entrar</button>

        <p class="login-note">
          <!-- Ahora apunta al sitio real -->
          <a href="{{ url_for('public.index') }}">← Ir al sitio sin iniciar sesión</a>
        </p>
      </form>
    </div>

  </div>

  <script>
    const rolSelect  = document.getElementById('rol');
    const usuarioInp = document.getElementById('usuario');
    const passInp    = document.getElementById('password');
    const form       = document.getElementById('form-login');

    // Cambiar comportamiento según el rol elegido
    function actualizarRol() {
      if (rolSelect.value === 'cliente') {
        // Cliente: no requiere usuario ni contraseña
        usuarioInp.disabled = true;
        passInp.disabled    = true;
        usuarioInp.value = '';
        passInp.value    = '';
        usuarioInp.placeholder = 'No requerido para clientes';
        passInp.placeholder    = 'No requerido para clientes';
      } else {
        // Admin: sí requiere ambos
        usuarioInp.disabled = false;
        passInp.disabled    = false;
        usuarioInp.placeholder = 'Usuario';
        passInp.placeholder    = 'Contraseña';
      }
    }

    rolSelect.addEventListener('change', actualizarRol);
    actualizarRol(); // al cargar la página

    // Acción del botón "Entrar"
    form.addEventListener('submit', function (e) {
      e.preventDefault();

      if (rolSelect.value === 'admin') {
        if (!usuarioInp.value.trim() || !passInp.value.trim()) {
          alert("Para Administrador debes escribir usuario y contraseña.");
          return;
        }
        alert("Inicio de sesión de ADMIN (demo).");
        // Admin también entra al sitio (puedes cambiarlo a admin.html si luego lo creas)
        window.location.href = "sitio.html";
        return;
      }

      if (rolSelect.value === 'cliente') {
        // Cliente entra directo al sitio principal
        window.location.href = "index.html";
      }
    });
  </script>
{% endblock %}
